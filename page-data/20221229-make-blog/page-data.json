{"componentChunkName":"component---src-templates-blog-post-js","path":"/20221229-make-blog/","result":{"data":{"site":{"siteMetadata":{"title":"Azara Posts"}},"markdownRemark":{"fields":{"slug":"/20221229-make-blog/"},"id":"18224e52-c238-5021-b098-790ccdfae083","excerpt":"ブログをHatenaからGatsbyのGitHub Pagesホスティングに移行しました。 以下は以降にあたり書き残した雑な技術メモです。 要件 記事をGitHub上で管理できる GitHub Pagesでホストする Blog記事とホスト用のコードは別のGitHub…","html":"<p>ブログをHatenaからGatsbyのGitHub Pagesホスティングに移行しました。</p>\n<p>以下は以降にあたり書き残した雑な技術メモです。</p>\n<hr>\n<h1 id=\"要件\" style=\"position:relative;\"><a href=\"#%E8%A6%81%E4%BB%B6\" aria-label=\"要件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>要件</h1>\n<ul>\n<li>記事をGitHub上で管理できる</li>\n<li>GitHub Pagesでホストする</li>\n<li>Blog記事とホスト用のコードは別のGitHub リポジトリを分離する</li>\n</ul>\n<h1 id=\"技術選定\" style=\"position:relative;\"><a href=\"#%E6%8A%80%E8%A1%93%E9%81%B8%E5%AE%9A\" aria-label=\"技術選定 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>技術選定</h1>\n<p>できる限り労力をかけずにブログを構築できる、かつ記事が多いというところ、また色々使っている人が多かった<code class=\"language-text\">Gatsby</code>を選択。(Reactを触ったことがあるので、 というのも一つではあるが。)</p>\n<ul>\n<li>Gatsby\n<ul>\n<li><a href=\"https://github.com/sungik-choi/gatsby-starter-apple\">GitHub - sungik-choi/gatsby-starter-apple: 🍎 Gatsby blog starter kit with beautiful responsive design</a></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"セットアップ\" style=\"position:relative;\"><a href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\" aria-label=\"セットアップ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>セットアップ</h1>\n<h2 id=\"環境情報\" style=\"position:relative;\"><a href=\"#%E7%92%B0%E5%A2%83%E6%83%85%E5%A0%B1\" aria-label=\"環境情報 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>環境情報</h2>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">node</span> <span class=\"token parameter variable\">-v</span>\n<span class=\"token comment\"># v18.12.1</span></code></pre></div>\n<h2 id=\"インストール\" style=\"position:relative;\"><a href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\" aria-label=\"インストール permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>インストール</h2>\n<p>まずは、<code class=\"language-text\">gatsby-cli</code>を導入し、gatsbyを利用できるようにする。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> gatsby-cli</code></pre></div>\n<h2 id=\"blogテンプレートの取得とlocalでの起動\" style=\"position:relative;\"><a href=\"#blog%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97%E3%81%A8local%E3%81%A7%E3%81%AE%E8%B5%B7%E5%8B%95\" aria-label=\"blogテンプレートの取得とlocalでの起動 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Blogテンプレートの取得とlocalでの起動</h2>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">gatsby new blog https://github.com/gatsbyjs/gatsby-starter-blog\n<span class=\"token builtin class-name\">cd</span> blog\ngatsby develop</code></pre></div>\n<p><code class=\"language-text\">gatsby develop</code>を実行後 <code class=\"language-text\">http://localhost:8000</code>で起動する。\n画面上では元から用意されているサンプル記事が表示される。</p>\n<h1 id=\"buildとgithub-pages-へのホスト\" style=\"position:relative;\"><a href=\"#build%E3%81%A8github-pages-%E3%81%B8%E3%81%AE%E3%83%9B%E3%82%B9%E3%83%88\" aria-label=\"buildとgithub pages へのホスト permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>BuildとGitHub Pages へのホスト</h1>\n<p>BuildとGitHub Pagesへのホストは、<a href=\"https://kanamesasaki.github.io/blog/20220124-gatsby-blog/\">Kaname Sasaki氏のブログ記事</a>を参考にする。</p>\n<h1 id=\"google-analytics-の導入\" style=\"position:relative;\"><a href=\"#google-analytics-%E3%81%AE%E5%B0%8E%E5%85%A5\" aria-label=\"google analytics の導入 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Google Analytics の導入</h1>\n<p>もともとHatenaでブログを書いており、アクセス解析等がデフォルトでついてることが普通だった。</p>\n<p>ただ、自身でホストするとなると、常にそのような機能があるわけではなく、自身で用意する必要がある。そこで、<code class=\"language-text\">gatsby-plugin-google-gtag</code>を用いる。</p>\n<p>インストールは下記のコマンドでできる。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> gatsby-plugin-google-gtag</code></pre></div>\n<p>次にGoogle Analyticsのアカウントを作成し、<code class=\"language-text\">gatsby-plugin-google-gtag</code>の設定に追加する。</p>\n<p><strong>gatsby-config.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n\t<span class=\"token comment\">// ~~snip~~</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-plugin-google-gtag</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">trackingIds</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"G-XXXXXXXXXX\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// Google Analytics のIDを追加</span>\n        <span class=\"token literal-property property\">pluginConfig</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">head</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>  <span class=\"token comment\">// headタグに追加する</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// ~~snip~~</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"目次の追加\" style=\"position:relative;\"><a href=\"#%E7%9B%AE%E6%AC%A1%E3%81%AE%E8%BF%BD%E5%8A%A0\" aria-label=\"目次の追加 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>目次の追加</h1>\n<p>ブログを書くと大体長くなるので目次をいい感じに追加してくれるプラグインを追加している。</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> gatsby-remark-table-of-contents\n<span class=\"token function\">npm</span> <span class=\"token function\">install</span> gatsby-remark-autolink-headers</code></pre></div>\n<p><code class=\"language-text\">gatsby-config.js</code>に先に追加したプラグインの設定を追加する。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ~~ snip ~~</span>\n      <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-transformer-remark</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">plugins</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-remark-autolink-headers</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">resolve</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">gatsby-remark-table-of-contents</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">options</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">exclude</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Table of Contents\"</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">tight</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">ordered</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">fromHeading</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">toHeading</span><span class=\"token operator\">:</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span>\n              <span class=\"token literal-property property\">className</span><span class=\"token operator\">:</span> <span class=\"token string\">\"table-of-contents\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">// ~~ snip ~~</span></code></pre></div>\n<p>表示用のコンポーネントを作成します。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">TableOfContents</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> html <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"toc\"</span> dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> html <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> TableOfContents </code></pre></div>\n<p>最後に<code class=\"language-text\">src/templates/blog-post.js</code>にテーブルを表示するコンポーネントを追加しておしまいです。</p>\n<p><strong>src/templates/blog-post.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> TableOfContents <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/tableOfContents\"</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">BlogPostTemplate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> previous<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">,</span> site<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">markdownRemark</span><span class=\"token operator\">:</span> post <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  location<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> siteTitle <span class=\"token operator\">=</span> site<span class=\"token punctuation\">.</span>siteMetadata<span class=\"token operator\">?.</span>title <span class=\"token operator\">||</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Title</span><span class=\"token template-punctuation string\">`</span></span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Layout location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>location<span class=\"token punctuation\">}</span> title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>siteTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>article\n        className<span class=\"token operator\">=</span><span class=\"token string\">\"blog-post\"</span>\n        itemScope\n        itemType<span class=\"token operator\">=</span><span class=\"token string\">\"http://schema.org/Article\"</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>header<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>h1 itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"headline\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>投稿<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>createDate<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>Tags<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>tags<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tag</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Link <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"taglink\"</span> to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/tags/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tag<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>tag<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>TableOfContents html<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>tableOfContents<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token comment\">// ~~ snip ~~</span></code></pre></div>\n<h1 id=\"tagの追加\" style=\"position:relative;\"><a href=\"#tag%E3%81%AE%E8%BF%BD%E5%8A%A0\" aria-label=\"tagの追加 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tagの追加</h1>\n<h2 id=\"front-matterによるタグとgatsbyのタグ\" style=\"position:relative;\"><a href=\"#front-matter%E3%81%AB%E3%82%88%E3%82%8B%E3%82%BF%E3%82%B0%E3%81%A8gatsby%E3%81%AE%E3%82%BF%E3%82%B0\" aria-label=\"front matterによるタグとgatsbyのタグ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>front matterによるタグとGatsbyのタグ</h2>\n<p>マークダウンのメタ情報を記述するfront matterのタグを元にホストするブログのタグを用意する。</p>\n<p>例えば下記の1のような情報をfront matterに記載していたとして、下記の2のようなgraphqlのクエリを Gatsby のページから発行することで、下記の3のようにタグを取得することができる。</p>\n<p><strong>1. front matterによるメタ情報の記述</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\"><span class=\"token front-matter-block\"><span class=\"token punctuation\">---</span>\n<span class=\"token front-matter yaml language-yaml\">title: 一年を振り返って\nauthor: Azara / @a_zara_n\ntags: [\"blog\"]\ncreateDate: 2022-12-31 18:04</span>\n<span class=\"token punctuation\">---</span></span></code></pre></div>\n<p><strong>2. Gatsbyのページ生成時にGraphqlで情報の取得をする</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n    <span class=\"token object\">markdownRemark</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">id</span>\n      <span class=\"token property-query\">excerpt</span><span class=\"token punctuation\">(</span><span class=\"token attr-name\">pruneLength</span><span class=\"token punctuation\">:</span> <span class=\"token number\">160</span><span class=\"token punctuation\">)</span>\n      <span class=\"token object\">frontmatter</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">title</span>\n        <span class=\"token property\">tags</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>3. 取得される情報</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"data\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"markdownRemark\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"419c83a0-b0e2-5d94-97d3-2d2d69e7491f\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"excerpt\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"年末の話 tags: #blog #振り返り はじめに 今年を振り返り 入社して1年 未熟さの実感 一念発起 ビールって美味しい 食わず嫌いをなくそうキャンペーン おわりに --–-\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"frontmatter\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"title\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"一年を振り返って\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token property\">\"tags\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"blog\"</span>\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"extensions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"タグを貼る\" style=\"position:relative;\"><a href=\"#%E3%82%BF%E3%82%B0%E3%82%92%E8%B2%BC%E3%82%8B\" aria-label=\"タグを貼る permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>タグを貼る</h2>\n<p>記事にタグを貼ることを考えた際に、次の三点を満たすことを前提に実装を進める。</p>\n<ol>\n<li>タグがつけられた記事の一覧を表示する</li>\n<li>トップページにTagを表示する\n<ol>\n<li>最小限で実装したいので、多くなった場合のことはこの際考慮しない</li>\n</ol>\n</li>\n<li>記事か1のページに遷移できる</li>\n</ol>\n<h3 id=\"タグに紐づけられた記事一覧ページ\" style=\"position:relative;\"><a href=\"#%E3%82%BF%E3%82%B0%E3%81%AB%E7%B4%90%E3%81%A5%E3%81%91%E3%82%89%E3%82%8C%E3%81%9F%E8%A8%98%E4%BA%8B%E4%B8%80%E8%A6%A7%E3%83%9A%E3%83%BC%E3%82%B8\" aria-label=\"タグに紐づけられた記事一覧ページ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>タグに紐づけられた記事一覧ページ</h3>\n<p>タグに紐づけられた記事一覧ページを実装するにあたり、2つのファイルを編集する。1つは既存の<code class=\"language-text\">gatsby-node.js</code>、もう1つは作成する<code class=\"language-text\">src/templates/tag.js</code>のファイルになる。</p>\n<p><code class=\"language-text\">src/templates/tag.js</code>は記事一覧の描画を担当するファイルで、下記のような実装をした。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span>\n<span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">\"prop-types\"</span>\n\n<span class=\"token comment\">// Components</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Link<span class=\"token punctuation\">,</span> graphql <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"gatsby\"</span>\n<span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/layout\"</span>\n\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Tags</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> pageContext<span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> siteTitle <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>site<span class=\"token punctuation\">.</span>siteMetadata<span class=\"token operator\">?.</span>title <span class=\"token operator\">||</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Title</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> tag <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> pageContext\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> edges<span class=\"token punctuation\">,</span> totalCount <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>allMarkdownRemark\n  <span class=\"token keyword\">const</span> tagHeader <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>totalCount<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> post</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>\n    totalCount <span class=\"token operator\">===</span> <span class=\"token number\">1</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"s\"</span>\n  <span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> tagged with \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tag<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"</span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Layout location title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>siteTitle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>article\n        className<span class=\"token operator\">=</span><span class=\"token string\">\"blog-post\"</span>\n        itemScope\n        itemType<span class=\"token operator\">=</span><span class=\"token string\">\"http://schema.org/Article\"</span>\n      <span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>header<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>h1 itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"headline\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>tagHeader<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>ol style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">listStyle</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">none</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n            <span class=\"token punctuation\">{</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> slug <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>fields\n                <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> title <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>frontmatter\n                <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n                    <span class=\"token operator\">&lt;</span>li key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n                    <span class=\"token operator\">&lt;</span>article\n                        className<span class=\"token operator\">=</span><span class=\"token string\">\"post-list-item\"</span>\n                        itemScope\n                        itemType<span class=\"token operator\">=</span><span class=\"token string\">\"http://schema.org/Article\"</span>\n                    <span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span>header<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>\n                            <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>slug<span class=\"token punctuation\">}</span> itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"url\"</span><span class=\"token operator\">></span>\n                            <span class=\"token operator\">&lt;</span>span itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"headline\"</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>title<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\n                            <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span>section<span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span>p\n                            dangerouslySetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>\n                            <span class=\"token literal-property property\">__html</span><span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>excerpt <span class=\"token operator\">||</span> <span class=\"token string\">\"aaaa\"</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n                            itemProp<span class=\"token operator\">=</span><span class=\"token string\">\"description\"</span>\n                        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n                        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>section<span class=\"token operator\">></span>\n                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span>\n                    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>li<span class=\"token operator\">></span>\n                <span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n            <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/tags\"</span><span class=\"token operator\">></span>All tags<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ol<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>article<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Layout<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nTags<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">pageContext</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">tag</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">allMarkdownRemark</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">totalCount</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">edges</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">arrayOf</span><span class=\"token punctuation\">(</span>\n        PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n          <span class=\"token literal-property property\">node</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n            <span class=\"token literal-property property\">frontmatter</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">title</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token literal-property property\">fields</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span><span class=\"token function\">shape</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n              <span class=\"token literal-property property\">slug</span><span class=\"token operator\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>isRequired\n      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Tags\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> pageQuery <span class=\"token operator\">=</span> graphql<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n  query($tag: String) {\n    site {\n        siteMetadata {\n            title\n        }\n    }\n    allMarkdownRemark(\n      limit: 2000\n      sort: {frontmatter: {date: ASC}}\n      filter: { frontmatter: { tags: { in: [$tag] } } }\n    ) {\n      totalCount\n      edges {\n        node {\n          fields {\n            slug\n          }\n          frontmatter {\n            title\n          }\n          excerpt\n        }\n      }\n    }\n  }\n</span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p><code class=\"language-text\">gatsby-node.js</code>は、先に作ったテンプレートを展開し、専用のページを作成に関連するコードを書いていく。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ~~snip~~</span>\n<span class=\"token keyword\">const</span> tagPage <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">./src/templates/tag.js</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/**\n * @type {import('gatsby').GatsbyNode['createPages']}\n */</span>\nexports<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">createPages</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> graphql<span class=\"token punctuation\">,</span> actions<span class=\"token punctuation\">,</span> reporter <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> createPage <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> actions\n\n  <span class=\"token comment\">// Get all markdown blog posts sorted by date</span>\n  <span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">graphql</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n    {\n      allMarkdownRemark(sort: { frontmatter: { date: ASC } }, limit: 1000) {\n        nodes {\n          id\n          fields {\n            slug\n          }\n          frontmatter {\n              tags\n          }\n        }\n      }\n      tagsGroup: allMarkdownRemark(limit: 1000) {\n        group(field: {frontmatter: {tags: SELECT}}){\n          fieldValue\n        }\n      }\n    }\n  </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// ~~snip~~</span>\n  <span class=\"token keyword\">const</span> tags <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>tagsGroup<span class=\"token punctuation\">.</span>group\n  \n  tags<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tag</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/tags/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tag<span class=\"token punctuation\">.</span>fieldValue<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">component</span><span class=\"token operator\">:</span> tagPage<span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">context</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token literal-property property\">tag</span><span class=\"token operator\">:</span> tag<span class=\"token punctuation\">.</span>fieldValue<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// ~~snip~~</span></code></pre></div>\n<h2 id=\"記事にtagを表示する\" style=\"position:relative;\"><a href=\"#%E8%A8%98%E4%BA%8B%E3%81%ABtag%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\" aria-label=\"記事にtagを表示する permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>記事にTagを表示する</h2>\n<p>記事に付与されたタグを表示し、関連記事の一覧ページに移動できるようにする。\n<strong>src/templates/blog-post.js</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ~~snip~~</span>\n          <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>Tags<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>post<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>tags<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">tag</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Link <span class=\"token keyword\">class</span><span class=\"token operator\">=</span><span class=\"token string\">\"taglink\"</span> to<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">/tags/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>tag<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>tag<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Link<span class=\"token operator\">></span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n<span class=\"token comment\">// ~~snip~~</span></code></pre></div>\n<h1 id=\"github-pagesへのデプロイ\" style=\"position:relative;\"><a href=\"#github-pages%E3%81%B8%E3%81%AE%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\" aria-label=\"github pagesへのデプロイ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GitHub Pagesへのデプロイ</h1>\n<p>GitHub PagesへのデプロイはBlog側のリポジトリでmainブランチへのpushがあった際にGitHub actionsを動作させ、一連の動作ののちに、<code class=\"language-text\">gh-pages</code>を用いてGitHub Pagesへデプロイしています。</p>\n<p><strong>インストール</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> gh-pages </code></pre></div>\n<h1 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h1>\n<ul>\n<li><a href=\"https://kanamesasaki.github.io/blog/20220124-gatsby-blog/\">GatsbyとGitHub Pagesで作るMarkdownブログ | Blog</a></li>\n<li><a href=\"https://zenn.dev/chot/articles/7f01dca5955c13\">Gatsby.js に Google Analytics を導入する</a></li>\n<li><a href=\"https://blog.ojisan.io/gatsby-create-tag/\">Gatsby製のブログにタグ機能を追加するための方法を見直してみよう | blog.ojisan.io</a></li>\n<li><a href=\"https://tech.glatchdesign.com/gatsby-table-of-contents/\">Gatsbyに目次を追加する | Glatch Tech</a></li>\n<li><a href=\"https://frontsensei.com/blog/post/sns-share-customize-of-gatsby-blog\">Gatsby（GatsbyJS）でSNSのSHAREを設置 | Gatsbyブログカスタマイズ | フロントセンセイ</a></li>\n</ul>\n<hr>\n<p><strong>Obsidian Tags</strong>\n: #blog #Gatsby</p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E8%A6%81%E4%BB%B6\">要件</a></p>\n</li>\n<li>\n<p><a href=\"#%E6%8A%80%E8%A1%93%E9%81%B8%E5%AE%9A\">技術選定</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97\">セットアップ</a></p>\n<ul>\n<li><a href=\"#%E7%92%B0%E5%A2%83%E6%83%85%E5%A0%B1\">環境情報</a></li>\n<li><a href=\"#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\">インストール</a></li>\n<li><a href=\"#blog%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E5%8F%96%E5%BE%97%E3%81%A8local%E3%81%A7%E3%81%AE%E8%B5%B7%E5%8B%95\">Blogテンプレートの取得とlocalでの起動</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#build%E3%81%A8github-pages-%E3%81%B8%E3%81%AE%E3%83%9B%E3%82%B9%E3%83%88\">BuildとGitHub Pages へのホスト</a></p>\n</li>\n<li>\n<p><a href=\"#google-analytics-%E3%81%AE%E5%B0%8E%E5%85%A5\">Google Analytics の導入</a></p>\n</li>\n<li>\n<p><a href=\"#%E7%9B%AE%E6%AC%A1%E3%81%AE%E8%BF%BD%E5%8A%A0\">目次の追加</a></p>\n</li>\n<li>\n<p><a href=\"#tag%E3%81%AE%E8%BF%BD%E5%8A%A0\">Tagの追加</a></p>\n<ul>\n<li>\n<p><a href=\"#front-matter%E3%81%AB%E3%82%88%E3%82%8B%E3%82%BF%E3%82%B0%E3%81%A8gatsby%E3%81%AE%E3%82%BF%E3%82%B0\">front matterによるタグとGatsbyのタグ</a></p>\n</li>\n<li>\n<p><a href=\"#%E3%82%BF%E3%82%B0%E3%82%92%E8%B2%BC%E3%82%8B\">タグを貼る</a></p>\n<ul>\n<li><a href=\"#%E3%82%BF%E3%82%B0%E3%81%AB%E7%B4%90%E3%81%A5%E3%81%91%E3%82%89%E3%82%8C%E3%81%9F%E8%A8%98%E4%BA%8B%E4%B8%80%E8%A6%A7%E3%83%9A%E3%83%BC%E3%82%B8\">タグに紐づけられた記事一覧ページ</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E8%A8%98%E4%BA%8B%E3%81%ABtag%E3%82%92%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B\">記事にTagを表示する</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#github-pages%E3%81%B8%E3%81%AE%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4\">GitHub Pagesへのデプロイ</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%8F%82%E8%80%83\">参考</a></p>\n</li>\n</ul>","frontmatter":{"title":"ブログをGitHub Pagesに移管する話","createDate":"December 29, 2022","date":"December 30, 2022","description":null,"tags":["blog","blog構築","Gatsby"]}},"previous":{"fields":{"slug":"/20221231-year-end/"},"frontmatter":{"title":"一年を振り返って"}},"next":null},"pageContext":{"id":"18224e52-c238-5021-b098-790ccdfae083","previousPostId":"419c83a0-b0e2-5d94-97d3-2d2d69e7491f","nextPostId":null}},"staticQueryHashes":["1790439409","3257411868"],"slicesMap":{}}